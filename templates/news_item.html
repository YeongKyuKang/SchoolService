{% extends "base.html" %}

{% block title %}{{ notice.title }}{% endblock %}

{% block hero %}
<section class="hero">
  <h1>University Notices</h1>
  <p>Stay updated with the latest announcements from our university</p>
</section>
{% endblock %}

{% block content %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        let currentPage = 1;
        const noticesPerPage = 3;
        let allNotices = [];
    
        function loadNotices() {
            fetch('/notice/api/notices')
                .then(response => response.json())
                .then(notices => {
                    allNotices = notices;
                    displayNotices();
                    updatePaginationButtons();
                })
                .catch(error => {
                    console.error('Error fetching notices:', error);
                });
        }
    
        function displayNotices() {
            const startIndex = (currentPage - 1) * noticesPerPage;
            const endIndex = startIndex + noticesPerPage;
            const noticesToShow = allNotices.slice(startIndex, endIndex);
    
            const noticeGrid = document.getElementById('notice-list');
            noticeGrid.innerHTML = '';
    
            noticesToShow.forEach(notice => {
                const noticeElement = document.createElement('div');
                noticeElement.className = 'notice-item notice-grid-item';
                noticeElement.innerHTML = `
                    
                    <h3><a href="/notice/news/${notice.id}">${notice.title}</a></h3>
                    <p class="notice-content">${notice.content.substring(0, 100)}...</p>
                    <p class="notice-date">${new Date(notice.date).toLocaleDateString()}</p>
                `;
                noticeGrid.appendChild(noticeElement);
            });
    
            document.getElementById('currentPage').textContent = currentPage;
        }
    
        function updatePaginationButtons() {
            const prevButton = document.getElementById('prevPage');
            const nextButton = document.getElementById('nextPage');
            const totalPages = Math.ceil(allNotices.length / noticesPerPage);
    
            prevButton.classList.toggle('disabled', currentPage === 1);
            nextButton.classList.toggle('disabled', currentPage === totalPages);
        }
    
        document.getElementById('prevPage').addEventListener('click', (e) => {
            e.preventDefault();
            if (currentPage > 1) {
                currentPage--;
                displayNotices();
                updatePaginationButtons();
            }
        });
    
        document.getElementById('nextPage').addEventListener('click', (e) => {
            e.preventDefault();
            const totalPages = Math.ceil(allNotices.length / noticesPerPage);
            if (currentPage < totalPages) {
                currentPage++;
                displayNotices();
                updatePaginationButtons();
            }
        });
    
        loadNotices();
    });
</script>
<section class="notice-detail">
  <h2 class="section-title">공지 사항</h2>
  <div class="notice-content-wrapper">
    <div class="notice-header">
      <h3 class="notice-title">{{ notice.title }}</h3>
      <p class="notice-date">{{ notice.date.strftime('%Y-%m-%d') }}</p>
    </div>
    <div class="notice-content">{{ notice.content }}</div>
  </div>
  <div class="back-button-container">
    <a href="{{ url_for('notice.index') }}" class="back-button">공지사항 목록으로 돌아가기</a>
  </div>
</section>
{% endblock %}

{% block extra_js %}

{% endblock %}

